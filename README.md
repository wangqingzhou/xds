<div align="center">
  <img alt="vue3-element-admin" width="80" height="80" src="./src/assets/logo.png">
  <h1>micrai-cms-admin</h1>



</div>

![](https://foruda.gitee.com/images/1708618984641188532/a7cca095_716974.png "rainbow.png")





## 项目简介

[micrai-cms-admin](https://gitee.com/hebwkznkjyxgs_admin/micrai-cms-admin.git) 基于 Vue3、Vite7、TypeScript 和 Element-Plus 搭建的极简AI后台管理前端模板，可用于网站后台、智能体后台、协同办公前端。 配套 Java 后端   和 python  智能体后端  。

## 项目特色

- **AI功能：**   同时与多个大模型对话中下指令，创作生成文本内容、视频，并分发到头条、抖音、小红书等。
- **数据交互**： [线上接口文档](http://micrai.com:8045/swagger-ui/index.html)，并提供配套的 [Java]  和 [python]  后端源码。
- **简洁易用**： Vue3版本的后台管理系统，可用于网站后台，协同办公、智能体后台。
- **系统功能：** 提供用户管理、角色管理、菜单管理、部门管理、字典管理、系统配置、文章管理 、栏目管理、日志管理等功能模块。
- **权限管理：** 支持动态路由、按钮权限、角色权限和数据权限等多种权限管理方式。
- **基础设施：** 提供国际化、多布局、暗黑模式、全屏、水印、接口文档等功能。
- **持续更新**：项目持续开源更新，实时更新工具和依赖。





关于“AI辅导员”项目
一、 作品创意阐述
“AI辅导员”是一款深度融合了人工智能技术的智慧教育平台。其核心创意在于将传统的学生信息管理系统与前沿的大语言模型（LLM）能力相结合，打造一个不仅限于信息记录，更具备“思考”和“辅导”能力的数字助手。

核心创意点如下：

从“记录”到“赋能”的转变：

传统系统：仅作为学生数据（班级、学号、成绩）的“档案库”，功能是静态和被动的。

AI辅导员：在数据基础之上，内置一个AI大脑。它不仅能存储信息，更能分析、理解并主动生成内容。例如，自动生成学生学习报告、识别学习困难群体、为教师提供个性化教学建议等。

个性化交互与支持：

通过自然语言处理（NLP）技术，系统可以提供7x24小时的智能问答支持。学生可以像与真人辅导员一样，用自然语言询问关于课程、作业、校园政策等问题，获得即时、准确的回答，极大减轻了人工辅导员重复性咨询的压力。

数据驱动的精准洞察：

系统不再是数据的坟墓，而是数据的“金矿”。通过分析学生的学习行为、成绩趋势、互动数据等，AI可以提前预警潜在学业风险的学生，并帮助教育管理者发现教学过程中的共性问题和优化点，实现从“经验驱动”到“数据驱动”的决策转变。

智能化工作流自动化：

将AI能力嵌入到具体工作流程中，如智能批改客观题、自动生成班级通知、辅助完成教务报告等，将教师和行政人员从繁琐的事务性工作中解放出来，使其能更专注于教学本身和与学生的深度交流。

简而言之，我们的创意不是做一个更好的“管理系统”，而是创造一个能够参与教学管理过程、提供智能支持的“AI同事”。

二、 面向的目标用户
我们的产品主要服务于教育生态中的三类核心用户：

核心用户：学生

需求：便捷的课程查询、成绩查看、即时的问题解答、个性化的学习反馈、与同学和老师的互动。

痛点：遇到问题时找不到老师；不清楚自己的学习状况；对冰冷的系统界面无感。

价值：获得一个随时随地、有问必答、且了解自己学习历史的“个人学业助手”，学习体验更流畅、更贴心。

关键用户：教师与辅导员

需求：高效管理班级和学生信息；轻松发布通知和作业；快速了解班级整体学情；与学生有效沟通。

痛点：大量时间被琐碎的行政事务和重复性问题占用；难以全面掌握每个学生的动态；缺乏高效的数据分析工具。

价值：AI成为其“教学助理”，自动化处理常规事务，并提供数据洞察，让其能更专注于教学设计、科研和与学生的深度辅导。

重要客户：学校及教育机构管理者

需求：掌控整体教学运行质量；优化资源配置；提升管理效率和现代化水平；做出科学决策。

痛点：数据分散，形成信息孤岛；决策依赖主观经验，缺乏数据支撑；难以量化评估教学效果。

价值：获得一个智慧教育决策支持系统，通过数据驾驶舱一目了然地看清全局，发现规律，预测趋势，从而实现更科学、精准的管理。

三、 市场的简单分析
市场趋势与机遇：

政策东风：“人工智能+教育”等政策，为教育数字化转型提供了强大的支持和明确的方向。

技术成熟：大语言模型技术的普及和API成本的下降，使得AI能力可以低成本、高效率地集成到传统应用中，技术门槛显著降低。

需求旺盛：线上线下融合（OMO）教学模式成为常态，学校对数字化工具的需求从“有”到“优”，从“工具”到“智慧”转变，市场存在巨大的升级替换空间。

竞争格局：

传统巨头：它们优势在于深耕多年，客户关系稳固，产品线齐全。但其产品往往传统、笨重、创新缓慢，AI能力通常是外挂而非内核。

新兴AI公司：一些初创公司提供纯AI解题、虚拟人等工具，技术新颖，但缺乏与校园实际管理和工作流深度结合的场景，容易沦为“玩具”。

我们的定位：我们恰好处于两者的结合点——既懂教育业务场景，又具备现代AI产品能力。做一个轻量化、AI原生、体验极致的智慧辅导平台，专注于解决“管理”和“辅导”中的核心痛点。

市场挑战：

用户习惯：改变教师和行政人员长期形成的使用习惯需要时间和有效的培训。

数据安全与隐私：教育数据极其敏感，必须建立最高等级的安全防护和隐私保护机制，符合《网络安全法》、《数据安全法》等要求。

销售周期：教育行业，特别是高校的采购决策流程长，需要深厚的渠道资源和耐心。


## 项目截图

🖥️ **控制台**

  <img src="./src/assets/1.png"/>
  <img src="./src/assets/2.png"/>
  <img src="./src/assets/3.png"/>
  <img src="./src/assets/ai.png"/>




## 项目启动

- **环境准备**

| 环境类型       | 名称                     |     备注          |
|----------------|---------------|----------- |
| **开发工具**   | [Visual Studio Code](https://code.visualstudio.com/Download) |
| **运行环境**   | ^20.19.0 || >=22.12.0  |    20.19.0+ 或 22.12.0 及以上版本   |


- **快速开始**

```bash
# 克隆代码
git clone https://gitee.com/hebwkznkjyxgs_admin/micrai-cms-admin.git

# 切换目录
cd vue3-element-admin

# 安装 pnpm
npm install pnpm -g

# 设置镜像源(可忽略)
pnpm config set registry https://registry.npmmirror.com

# 安装依赖
pnpm install

npm install pdfjs-dist --save

# 启动运行
pnpm run dev
```


## 项目部署

执行 `pnpm run build` 命令后，项目将被打包并生成 `dist` 目录。接下来，将 `dist` 目录下的文件上传到服务器 `/usr/share/nginx/html` 目录下，并配置 Nginx 进行反向代理。

```bash
pnpm run build
```

以下是 Nginx 的配置示例：

```nginx
server {
    listen      80;
    server_name localhost;

    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }

    # 反向代理配置
    location /prod-api/ {
        # 请将  端口 8045 替换为您的后端 端口 地址，并注意保留后面的斜杠 /
        proxy_pass http://localhost:8045/;
    }
}
```


## 后端接口

> Java后台，按照以下步骤将在线接口转为本地后端接口，创建企业级前后端分离开发环境，助您走向全栈之路。

1. 获取基于 `Java` 和 `SpringBoot` 开发的后端  源码。
2. 根据后端工程的说明文档 [README.md]  完成本地启动。
3. # 线上  .env.production 中的  VITE_APP_API_URL = ''  # 关键修改：留空后，请求会自动使用当前页面的域名（如 demo.micrai.com）
4.json 示例：
{
    "chatMessages": [],
    "tools": [
        "read_first_chunk",
        "read_next_chunk",
        "read_previous_chunk",
        "ask_user",
        "finish_with_summary",
        "plan",
        "replace_document",
        "apply_diff"
    ],
    "modelName": "gpt-4.1",
    "schemaAwarenessData": {
        "extensionNames": [
            "link",
            "paragraph",
            "editable",
            "clipboardTextSerializer",
            "commands",
            "focusEvents",
            "keymap",
            "tabindex",
            "drop",
            "paste",
            "delete",
            "starterKit",
            "bold",
            "blockquote",
            "bulletList",
            "code",
            "codeBlock",
            "doc",
            "dropCursor",
            "gapCursor",
            "hardBreak",
            "heading",
            "undoRedo",
            "horizontalRule",
            "italic",
            "listItem",
            "listKeymap",
            "orderedList",
            "strike",
            "text",
            "underline",
            "trailingNode",
            "aiAgent",
            "tiptapAiAgentInlineSelection",
            "tiptapAiAgentBlockSelection"
        ],
        "customNodes": []
    }
}







{
    "model": "ai",
    "messages": [
        {
            "id": "b3a6376a-f069-406f-869c-59e90a80dad5",
            "role": "user",
            "content": "学校有多少人",
            "timestamp": 1757214457
        },
        {
            "id": "77993904-2cbc-4e8b-9469-6842a9e89c8f",
            "role": "assistant",
            "content": "根据最新数据，各类在校研究生近2900人[1]。人始终保持着艰苦奋斗的精神，欢迎你加入这个大家庭！😊 需要了解其他信息可以随时问我~",
            "timestamp": 1757214457,
            "usage": {
                "completion_tokens": 53,
                "prompt_tokens": 592,
                "total_tokens": 645
            },
            "sources": [
                {
                    "source": {
                        "id": "60586595-6b66-4ed1-838a-dbc249ca438f",
                        "user_id": "70ced502-d430-4022-a4ae-80ddb7c2ab26",
                        "name": "学校简介",
                        "description": "学校简介",
                        "meta": null,
                        "access_control": {
                            "read": {
                                "group_ids": [
                                    "b6c656ae-4cca-4786-b0c9-bba9a2453cae",
                                    "56fa3880-ea49-4888-ba25-20794303b441"
                                ],
                                "user_ids": []
                            },
                            "write": {
                                "group_ids": [],
                                "user_ids": []
                            }
                        },
                        "created_at": 1757212211,
                        "updated_at": 1757212294,
                        "user": {
                            "id": "70ced502-d430-4022-a4ae-80ddb7c2ab26",
                            "name": "micrai",
                            "email": "22104416@qq.com",
                            "Student_ID": null,
                            "Mobile": "15663822501",
                            "className": null,
                            "role": "admin",
                            "profile_image_url": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAABPFJREFUeF7tnW+IFHUcxp8ZZ26360wtqHdedpaa0KsKTgkyMMo6+ktgvQhLkiDoRX9fFfTGtII4Kkik6EVCUVSU/bHI/HthofiPUlJJ08s/peR1uzOzMxMz2647u3O3s5PGEz0L9+Zu5zcPz2efZ76/3TnWOL3ywhB60DhgCAgNi1iIgHDxEBAyHgIiIGwOkOnRNURAyBwgk6OECAiZA2RylBABIXOATI4SIiBkDpDJUUIEhMwBMjlKiICQOUAmRwkREDIHyOQoIQJC5gCZHCVEQMgcIJOjhAgImQNkcpQQASFzgEyOEiIgZA6QyVFCBITMATI5dAnpvmszzMkzkjYFLtztg3C3Ls1ln2H34LxbPoZ50VWJ44NTezD6/pxca56rg/4bQAD4R9aj9NkduXyw+u5GoX8ZjMJkAenUwdSEAAhHh1Fe9zD8Ixs6XRKFuS/CnnE/YJgC0ql7YwFBztoaq64iXaqsDHQSQMIAiH5MKz4yT23Zly9EV/9SGPbE6lqGEf3jWLyegHQIJPT+RFg+AXNib3xkntoqXDcI+4p7Ywhh6Rhg98CwugUkA4v4KY0JCb0R+Ie/gdW7oNr/vgN323K421/OtFxcVwNfwJwyM8IJ//A6mBdfjej3SkgmC1uBeDtfhT17SX1Cqhxag/KahZlWa6yr0DsNb/eK6loCksm/1IS4Q0/Dnv1QfQ8RjhxCee1i+Me+b7toY10FJ3+Et/MVdPU/LyBtnWt4QnNlOZufwIRLrj0ztmasLXNSH4rzV8GcND2uK2/vKvjDG1GY84KA/FMg0XTUuLHLUlv2rAfRdc2zMOzzETqn4Aw9FV+HBKQTGikX9Sgh/s+fJt76yFJbxetXwOq7M56ugt92oLR6ABN6FwhIhzxapqwISOWnd5O77Ta1lairMIC35y04mx6HNf0eATlbQJrfjxqvttLqqrLvPQHpFEbaPqSWkPhvt6+tT1vByEGUv34AwfFtLadJq6toT6OE5CCSNmVFlRU9Cv3LYc9a9PcmsQx36zK4OwYTZ4nr6sZ3YF4wLX6rxPvhTThDT8bPEZCzDMSadhsKc1+CUZgSr1w5+DnKX96XOIt95eLqdGV1I3ROwtn0GCoHPhKQHCxSN4aNlZWltorzVsK6rPq5STRdjX44ry5FCclBZbzKaldbiboKKvB2vw5nyzMCkoND/ZB2QMarrURdlU7A2fhoXGu1hxKSg0w7IOPVVnH+27Cm3hSf1T+6BaVPbk4oEJBzBCRt2qoMb0Dxhjdg9kwFUupKU1YOGPGrv+Guk2jv0HxRj41tnrb2fwD/6LdnpqvScZTXPwL/l6+UkJwcMl9Dak9MbBL/OIDg912wLh2o1tWvQyitvrVFiiorB50sCWmZtiolhL5T/RAr8ODueg3ud88JSA7/Ww7JCqS5tmoLhWPUla4hOelkBdI8bdVON1ZdCci/ACQxbUXna3Pvlq4hOaB0kpDm2mp3m5CA5ADyfz+E7mZrAdHXVVC9BpQQKhz6ugoyHAIiIHQOkAnSNURAyBwgk6OECAiZA2RylBABIXOATI4SIiBkDpDJUUIEhMwBMjlKiICQOUAmRwkREDIHyOQoIQJC5gCZHCVEQMgcIJOjhAgImQNkcpQQASFzgEyOEiIgZA6QyVFCBITMATI5SoiAkDlAJkcJERAyB8jkKCECQuYAmZy/AKgE6hLFM5iHAAAAAElFTkSuQmCC"
                        },
                        "files": [
                            {
                                "id": "e8efd7c4-b0ce-4a4d-b4de-ea28aa75316a",
                                "meta": {
                                    "name": "学校简介.txt",
                                    "content_type": "text/plain",
                                    "size": 7839,
                                    "data": {},
                                    "collection_name": "60586595-6b66-4ed1-838a-dbc249ca438f"
                                },
                                "created_at": 1757212294,
                                "updated_at": 1757212294
                            }
                        ],
                        "type": "collection"
                    },
                    "document": [
                        "农业科学学科连续两年进入ESI全球排名前1%;本科招生专业50个,其中国家级特色专业3个、省级重点专业9个,国家级一流专业建设点8个、省级一流专业16个。",
                        "以强农兴农为己任,以服务龙江高质量发展可持续振兴、服务国家农业现代化为办学使命,以产教融合发展为导向,以质量提升为核心,着力提高学校内涵发展水平和办学综合实力,固本拓新,奋楫图强,为奋力谱写特色高水平研究应用型农业大学建设新篇章而努力奋斗。\n\n (截至2025年5月)",
                        "与近30所高校和科研院所开展中外导师联合培养研究生项目,累计培养博士、硕士研究生36人。"
                    ],
                    "metadata": [
                        {
                            "content_type": "text/plain",
                            "created_by": "70ced502-d430-4022-a4ae-80ddb7c2ab26",
                            "data": "{}",
                            "embedding_config": "{'engine': '', 'model': 'sentence-transformers/all-MiniLM-L6-v2'}",
                            "file_id": "e8efd7c4-b0ce-4a4d-b4de-ea28aa75316a",
                            "hash": "6d109f4df2645f93454c7e415cb8c146349edd3d37864247ba84a2caa118cd85",
                            "name": "学校简介.txt",
                            "size": 7839,
                            "source": "学校简介.txt",
                            "start_index": 0
                        },
                        {
                            "content_type": "text/plain",
                            "created_by": "70ced502-d430-4022-a4ae-80ddb7c2ab26",
                            "data": "{}",
                            "embedding_config": "{'engine': '', 'model': 'sentence-transformers/all-MiniLM-L6-v2'}",
                            "file_id": "e8efd7c4-b0ce-4a4d-b4de-ea28aa75316a",
                            "hash": "6d109f4df2645f93454c7e415cb8c146349edd3d37864247ba84a2caa118cd85",
                            "name": "学校简介.txt",
                            "size": 7839,
                            "source": "学校简介.txt",
                            "start_index": 2320
                        },
                        {
                            "content_type": "text/plain",
                            "created_by": "70ced502-d430-4022-a4ae-80ddb7c2ab26",
                            "data": "{}",
                            "embedding_config": "{'engine': '', 'model': 'sentence-transformers/all-MiniLM-L6-v2'}",
                            "file_id": "e8efd7c4-b0ce-4a4d-b4de-ea28aa75316a",
                            "hash": "6d109f4df2645f93454c7e415cb8c146349edd3d37864247ba84a2caa118cd85",
                            "name": "学校简介.txt",
                            "size": 7839,
                            "source": "学校简介.txt",
                            "start_index": 1468
                        }
                    ],
                    "distances": [
                        0.6436462879656595,
                        0.6287162434418825,
                        0.6240660336057893
                    ]
                }
            ]
        }
    ],
    "chat_id": "6214c52e-65b4-42c1-b158-3cf714aadec4",
    "session_id": "_i6Cv6hghan_w36IAAAl",
    "id": "77993904-2cbc-4e8b-9469-6842a9e89c8f"
}

Thanks to all the contributors!
感谢所有的贡献者！




## 特别感谢

- 感谢 [GitCode](https://gitcode.com/) 官方的 [G-Star](https://gitcode.com/g-star) 认证

## 演示网址

-  [演示网址](http://demo.micrai.com/) http://demo.micrai.com/   管理员帐号：test1  密码：111111




## 加群交流
[] <img alt="微智能体全栈交流群" width="280"  src="./src/assets/wx.jpg">

② 直接添加微信 **`cwebcrm`** 备注「前端/后端/全栈」。











-- 选调生材料申请表
CREATE TABLE `material_application` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `student_id` varchar(50) NOT NULL COMMENT '学号',
  `student_name` varchar(50) NOT NULL COMMENT '姓名',
  `school` varchar(100) NOT NULL COMMENT '毕业院校',
  `major` varchar(100) NOT NULL COMMENT '专业',
  `education` varchar(20) NOT NULL COMMENT '最高学历',
  `graduation_date` date NOT NULL COMMENT '毕业日期',
  `political_status` varchar(20) NOT NULL COMMENT '政治面貌',
  `party_proof_file_ids` varchar(500) DEFAULT NULL COMMENT '党员证明文件ID列表',
  `party_valid` varchar(10) DEFAULT NULL COMMENT '党员证明真实性确认',
  `cadre_experience` varchar(20) DEFAULT NULL COMMENT '学生干部经历',
  `cadre_position` varchar(100) DEFAULT NULL COMMENT '具体职务',
  `cadre_proof_file_id` varchar(50) DEFAULT NULL COMMENT '学生干部证明文件ID',
  `cadre_valid` varchar(10) DEFAULT NULL COMMENT '学生干部证明真实性确认',
  `military_experience` varchar(10) DEFAULT NULL COMMENT '参军入伍经历',
  `military_proof_file_id` varchar(50) DEFAULT NULL COMMENT '入伍证明文件ID',
  `military_valid` varchar(10) DEFAULT NULL COMMENT '入伍证明真实性确认',
  `award_level` varchar(20) DEFAULT NULL COMMENT '获奖级别',
  `award_name` varchar(200) DEFAULT NULL COMMENT '获奖名称',
  `awards_proof_file_ids` varchar(500) DEFAULT NULL COMMENT '获奖证书文件ID列表',
  `award_valid` varchar(10) DEFAULT NULL COMMENT '获奖证书真实性确认',
  `ranking_level` varchar(20) NOT NULL COMMENT '专业排名区间',
  `failed_courses` varchar(20) NOT NULL COMMENT '不及格课程',
  `transcript_file_id` varchar(50) NOT NULL COMMENT '成绩单文件ID',
  `transcript_valid` varchar(10) NOT NULL COMMENT '成绩单真实性确认',
  `rank_proof_file_id` varchar(50) NOT NULL COMMENT '专业排名证明文件ID',
  `rank_valid` varchar(10) NOT NULL COMMENT '排名证明真实性确认',
  `id_card_file_id` varchar(50) NOT NULL COMMENT '身份证文件ID',
  `id_valid` varchar(10) NOT NULL COMMENT '身份证真实性确认',
  `overall_valid` varchar(10) NOT NULL COMMENT '总体声明确认',
  `score` decimal(5,2) DEFAULT NULL COMMENT '计算得分',
  `status` varchar(20) DEFAULT 'draft' COMMENT '状态（draft：草稿，submitted：已提交）',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_student_id` (`student_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='选调生材料申请表';




“信小艾”AI辅导员项目由哈尔滨微孔智能科技有限公司开发，旨在通过基于大语言模型（LLM）和知识库驱动的智能助手平台，辅助高校辅导员进行学生管理。该系统采用模块化、分层式架构设计，具备核心业务逻辑处理、智能推理与语义理解、数据存储与管理等功能。系统支持多租户架构，适用于不同高校或院系独立部署。核心目标包括减轻辅导员工作负担、提供7×24小时在线咨询服务、实现智能响应等。通过集成多种关键技术，如知识库处理、安全与合规机制等，系统确保了高可用性、强安全性和易配置性。


“信小艾”AI辅导员项目的创新功能点包括：
1. 知识增强型生成（RAG）：结合大语言模型和知识库，避免回答错误。
2. 多场景智能响应：实现政策解读、学业指导、心理支持等智能响应。
3. 全天候在线咨询：提供7×24小时在线服务，减轻辅导员负担。
4. 精细化模型配置：管理员可对AI助手进行详细配置，包括模型选择、提示词设计等。
5. 心理边界控制：心理类模型中加入“非医疗建议”声明，识别高风险对话并预警。
6. 多租户架构：支持不同高校或院系独立部署，确保数据隔离。
7. 可扩展性设计：支持模型更新和第三方系统对接，多语言支持。
8. 日志审计与数据隔离：记录所有对话和操作。


        审核状态	17
		草稿	DRAFT
		已提交	SUBMITTED
		已退回	RETURNED
		已审核	APPROVED


	-- 计算学业成绩学院审核分（20分）
	UPDATE material_form mf
	JOIN (
	    SELECT MAX(gpa_score) AS max_gpa
	    FROM material_form
	    WHERE gpa_score IS NOT NULL
	) AS max_gpa ON 1=1
	SET mf.college_score_academic =
	    CASE
	        WHEN max_gpa.max_gpa = 0 THEN 0
	        ELSE ROUND((mf.gpa_score / max_gpa.max_gpa) * 20, 2)
	    END
	WHERE mf.gpa_score IS NOT NULL;



	-- 计算学业奖励学院审核分（10分）
	-- 1. 创建临时表存储字典数据
	CREATE TEMPORARY TABLE temp_dict_scholarship AS
	SELECT
	    id,
	    name,
	    score
	FROM sys_dicttree
	WHERE type = 'scholarship' AND id IN (38, 39, 40, 41)
	ORDER BY score DESC;# 影响列数： 4
  -- 按分值降序排列，确保取最高分
	-- 2. 创建临时表存储每个学生的奖学金最高分
	CREATE TEMPORARY TABLE temp_student_scholarship AS
	SELECT
	    mf.id,
	    mf.student_name,
	    mf.scholarship,
	    -- 获取学生奖学金的最高分：先去掉方括号，然后按逗号分割，再匹配字典
	    (
	        SELECT MAX(ds.score)
	        FROM temp_dict_scholarship ds
	        WHERE FIND_IN_SET(ds.id, REPLACE(REPLACE(mf.scholarship, '[', ''), ']', '')) > 0
	    ) AS max_scholarship_score
	FROM material_form mf;# 影响列数： 3

	-- 3. 计算整个表的最高分
	SET @max_scholarship_score = (SELECT MAX(max_scholarship_score) FROM temp_student_scholarship);# MySQL 返回的查询结果为空(即零行)。

	-- 4. 更新原表中的学业奖励学院审核分
	UPDATE material_form mf
	JOIN temp_student_scholarship t ON mf.id = t.id
	SET mf.college_score_scholarship =
	    CASE
	        WHEN t.max_scholarship_score IS NULL OR @max_scholarship_score = 0 THEN 0
	        ELSE ROUND((t.max_scholarship_score / @max_scholarship_score) * 10, 2)
	    END;# 影响列数： 3

	-- 5. 删除临时表
	DROP TEMPORARY TABLE temp_dict_scholarship;# MySQL 返回的查询结果为空(即零行)。

	DROP TEMPORARY TABLE temp_student_scholarship;# MySQL 返回的查询结果为空(即零行)。



CREATE VIEW BQLHT AS SELECT  (SELECT NAME FROM org_unit WHERE ID=f.field0118) AS '单位', COUNT(*) AS '录入数据', (SELECT COUNT(*)
FROM formmain_83819 a WHERE field0009 IN (SELECT ID FROM ctp_enum_item WHERE SHOWVALUE in("履行","完结")) AND f.field0118=a.field0118) AS '签订数据',CONCAT(ROUND((SELECT COUNT(*) FROM formmain_83819 a WHERE field0009 IN (SELECT ID FROM ctp_enum_item WHERE SHOWVALUE in("履行","完结")) AND f.field0118=a.field0118)/count(*)*100,2),'%') AS '数据填报完成率'
FROM formmain_83819 f GROUP BY f.field0118;

CREATE VIEW BQLHTNUM AS
select (SELECT NAME FROM org_unit WHERE ID=f.field0185) AS '单位', COUNT(*) AS '项目数量'
from formmain_73770  f
where field0210 IN (SELECT ID FROM ctp_enum_item WHERE SHOWVALUE in("立项完成","审批完成","待施工","施工中","初验","终验")) and field0266 in (SELECT ID FROM ctp_enum_item WHERE SHOWVALUE in("一级"))
group by f.field0185





